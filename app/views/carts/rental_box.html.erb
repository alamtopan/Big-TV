 <section class="wraper_bg-bright extra_packages">
  <h1><span>SEWA DEKODER</span></h1>
  <div class="polosochka2"></div>
  <h3>Kini anda dapat menimakti tayangan BigTV lebih dari 1 televisi 
    <br>dengan menggunakan dekoder tambahan.
    <br>minimal berlangganan BigStar 117.</h3>
  <article class="packs-cont cbp-so-scroller" style="text-align:left">
    <div class="panel-body">
      <div class="row-fluid">
        <div class="span9">
          <div class="section_decode">
            <% if(flash[:alert]) %>
              <div id="error_explanation">
                <div class="alert alert-block alert-danger fade in ">
                  <%= flash[:alert] %>
                </div>
              </div>
            <% end %>
            <div class="grd_masonry_decode2">
              <% default_decoder = @memberships.first %>
              <% @memberships.each_with_index do |member, index| %>
                <% add_class = index == 0 ? 'pck_decode_table_active' : '' %>      
                <div class="grid_packages_decode pck_decode">
                  <div class="head_pack red">
                    <span class="small-counter2"><%= member.name %></span>
                  </div>
                  <table class="table table-bordered padding0 decode pck_decode_table <%= add_class %>" data-index="<%= member.id %>" data-price="<%= member.price_month %>">
                    <tbody>
                      <tr>
                        <td>
                          <div class="br"></div>
                          <div class="pack-info">
                            <div class="pack-i-line">
                              Rp.
                              <span class="prc">
                                <%= number_to_currency(member.price_month,{precision: 0, unit: ''}) %>
                              </span>
                              <div>/month</div>
                            </div>
                          </div>
                          <div class="br"></div>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              <% end %>
            </div>
             <span class="warn">*) Untuk berlangganan paket wajib menyewa minimal 1 decoder</span>
          </div>
          <div class="section_decode">
            <div class="own_extra full100">
              <%= form_tag(carts_path, method: "post") do %>
                <%= hidden_field_tag 'membership_id', (default_decoder ? default_decoder.id : ''), class: 'membership-id-field' %>
                <input class="pack-order float-right-fixed margn full100" type="submit" value="Lanjut >>" >
              <% end %>
            </div>
          </div>
          <% if flash[:upgrade_channel] %>
            <div class="section_decode">
              <div class="alert alert-block alert-danger fade in align-center ">
                Your Premium Package Must Be least Big Star Package !
              </div>
              <div class="grd_masonry_decode2">
                <% @upgrades.each do |upgrade_package| %>
                  <div class="grid_packages_decode">
                    <div class="head_pack red">
                      <div class="big-decode2">BiG</div>
                      <span class="small-counter2"><%= upgrade_package.name %></span>
                    </div>
                    <table class="table table-bordered padding0 decode">
                      <tbody class="gray_packages">
                        <tr>
                          <td>
                            <div class="br"></div>
                            <div class="pack-info">
                              <div class="pack-i-line">
                                Rp.
                                <span class="prc">
                                  <%= number_to_currency(upgrade_package.price_month,{unit: '', precision: 0}) %>
                                </span>
                              </div>
                            </div>
                            <div class="br"></div>          
                            <%= link_to extra_path(membership_id: upgrade_package.id),{class: 'no_underscore'} do %>
                              <div class='pack-order version2'>SUBSCRIBE</div>
                            <% end %>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                <% end %>
              </div>
            </div>
          <% end %>
        </div>
        <div class="span3">
          <div class="grid_packages_decode2 white46">
            <div class="head_pack_gray radius_top">
              <span>PAKET YANG DIPESAN</span>
            </div>
            <table class="table table-bordered padding0 decode2">
              <tbody>
                <tr>
                  <td>
                    <% other_package_id = 0 %>
                    <% @order.items.each do |item| %>
                      <% if item.membership_category == 'Premium' %>
                        <script>
                           var current_package_name = '<%= item.membership.name %>';
                        </script>
                        <div class="pack-info">
                          <div class="big-decode font_red">BiG</div>
                          <span class="small-decode font_red"><%= item.membership.name %></span>
                          <div class="br-small"></div>
                          <div class="pack-i-line">
                            Rp.
                            <span class="prc">
                              <%= number_to_currency(item.subtotal,{precision: 0, unit: ''}) %>
                            </span>
                          </div>
                        </div>
                      <% elsif item.membership_category == 'Extra' %>
                        <div class="pack-info additional-pack">
                          <span class="small-decode font_red"><%= item.membership.name %></span>
                          <div class="br-small"></div>
                          <div class="pack-i-line">
                            Rp.
                            <span class="prc">
                              <%= number_to_currency(item.subtotal,{precision: 0, unit: ''}) %>
                            </span>
                          </div>
                        </div>
                      <% else %>
                        <% other_package_id = item.membership_id %>
                      <% end %>
                    <% end %>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </article>
</section>

<script>
  window.upgrade_packages = JSON.parse('<%= @upgrades.to_json.html_safe %>');
</script>